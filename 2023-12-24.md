## コンピューティング
#### VM 上の SQL Server の推奨事項(キャッシュポリシー)
- トランザクションログディスク: なし
- データディスク: 読み取り専用

#### Log Analytics に保存されるログ
- Event: Win のイベントログ
- Syslog: Linux のイベントログ
- Perf: パフォーマンスカウンター
- Heartbeat: エージェントの正常性を示すログ

### Azure Function
- サポートされているランタイムは以下
  - C#
  - JS/TS
  - Java
  - Python(Linux のみ)
  - PowerShell Core
- 最大インスタンス数は Win: 200, Linux: 100(従量課金)
- プランは以下
  - 従量課金
    - タイムアウト期間が最大で10分
    - 受信 IP の制限は可能
  - Premium
    - **Vnet 接続をサポート**(ネットワークインジェクションを有効にする)
    - インスタンスが常にウォーム状態
    - タイムアウトは無制限
  - 専用
    - 手動スケーリング可能
- **ログ書き込みは不可**

### Azure Bastion
- HTTPS(443) で Vnet に接続し, RDP/SSH(3389/22) で仮想マシンに接続

### Just-In-Time VM アクセス (JIT)
- 一時的に RDP や SSH を許可する


## Azure Storage Account
### 不変ストレージ
- WORM(Wtire Once, Read Many) 状態で保存できる
- 汎用 v2 または Premium ブロック BLOB でサポート
- "時間ベースのアイテム保持ポリシー", "訴訟ホールドポリシー" がある

### Premium ブロック BLOB
- 最も回復力を高められるのは ZRS
  - GRS はサポートされていない


## 負荷分散
- [負荷分散サービスの使い分け](https://learn.microsoft.com/ja-jp/azure/architecture/guide/technology-choices/load-balancing-overview)

### Azure Front Door
- WAF, TLS 終端, URL ベースのルーティング, Cookie ベースのセッションアフィニティ機能 などがサポートされる
- [レート制限](https://learn.microsoft.com/ja-jp/azure/web-application-firewall/afds/waf-front-door-rate-limit)をサポート
  - > ソケット IP アドレスからの異常に高いレベルのトラフィックを検出してブロックできます
  - 
- グローバルサービス
  - **リージョン障害から保護可能**

### API Management
- ロジックアプリをバックエンドの API に設定可能
- rate-limit ポリシーを設定可能
  - 指定期間あたりの呼び出しレートを指定数に制限する
  - 超えた分は `429 Too Many Request` を返す


## Microsoft Entra ID
### アクセスレビュー
> ユーザーのアクセス許可を定期的にレビューし、適切なユーザーのみが継続的なアクセス権を持っていることを確認することができます。
- レビューされなかった場合のアクションも設定可能
  - アクセス許可を自動で削除する, など

### 管理グループ
- **同じテナントを信頼するサブスクリプション**をまとめて管理できる
  - 異なるサブスクリプションを1つの管理グループにまとめることはできない

### Azure Blueprints
- プロジェクトの設計図
  - リソースグループ, ARM テンプレート, ポリシー割り当て, ロール割り当てなどを含む(アーティファクト)
  - ARM テンプレートより上位の概念?
- 管理グループやサブスクリプションに対して保存できる
  - **同じブループリントを別のテナントに適用することは不可**
- 割り当てはサブスクリプション単位で実行することが必要
  - 管理グループ単位で割り当てることはできない

### マネージド ID
- ユーザー割り当てマネージド ID は複数のリソースに関連付けることができる
  - システム割り当ての場合はリソースごと
  - 複数の仮想マシンに紐づけ, まとめてアクセス可能にできる

### Microsoft Entra アプリケーションプロキシ
- > オンプレミスの Web アプリケーションへのセキュリティで保護されたリモート アクセスを提供します。Microsoft Entra ID にシングル サインオンした後、ユーザーは、外部の URL または内部のアプリケーション ポータルから、クラウド アプリケーションとオンプレミス アプリケーションの両方にアクセスできます。
- [アプリケーション プロキシの動作](https://learn.microsoft.com/ja-jp/entra/identity/app-proxy/application-proxy#how-application-proxy-works)
  - アプリケーションへのアクセス時に, プロキシによって Entra のサインインページに送られる
  - サインインに成功すると, ユーザーにトークンが送信される
  - トークンをプロキシを介してアプリケーションプロキシコネクタに送信する
  - コネクタはユーザーの代わりに必要な認証を実行
  - コネクタがアプリケーションに要求を送信
  - コネクタとプロキシ経由で通信する

### Privileged Identity Management (PIM)
- Premium P2 ライセンスが必要
- 下記の機能あり
  - 期限付きのアクセス権の割り当て
  - 特権ロールがアクティブ化されたときに通知を受ける
  - アクセスレビューの実施
  - ロールに関するアクティビティを表示


## PaaS サービス
### SQL Server
#### サービスレベル
- レイテンシを最低限に押さえるには Premium または Bussiness Critial を選択
  - ローカル SSD を利用
- Premium または Bussiness Critical ではゾーン冗長を選べる

#### 透過的なデータ暗号化に必要なキー
- RSA または RSA HSM
- キー長は 2048 または 3072 バイト

#### エラスティックプール
- リソースプールを作成し, 複数のデータベースで共有できるようにする
- 複数のデータベースを移行に利用できる

### Azure Batch
- 大規模な並列コンピューティングやハイパフォーマンス コンピューティング (HPC) のバッチ ジョブを効率的に実行するためのサービス

### Azure Data Factory
- データ連携ツール
- オンプレミスからストレージアカウントへの連携も可能

### Azure Key Vault
- 別の Vault への移行に必要な権限は下記
  - 移行元のシークレットに対する Get 権限
    - 全てのシークレットを取得する List 権限もある
  - 移行先のシークレットに対する Set 権限


## その他
### Azure Migrate
- オンプレミスから Azure への移行をサポート
- 評価ツールからサイズの推定やコストの見積もりができる

### Azure Time Series Insights
- 時系列データ向けフルマネージドサービス
- > IoT Hubまたは、Event Hubからストリーミングデータを受け取り、ほぼリアルタイムでデータを処理、保存、クエリ、視覚化することができます。
