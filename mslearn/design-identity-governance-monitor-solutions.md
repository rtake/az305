# 管理グループ
## できること
- 複数のサブスクリプションを対象に, リソースのリージョンを制限できる
  - ポリシーとイニシアティブ割り当ての集約
- 複数のサブスクリプションにアクセスできるようにロールを割り当てることができる
- サブスクリプションをまたいでロールやポリシーの割り当ての監視と監査が可能

## 特性
- 管理グループに対する RBAC は既定では有効にならない
- 6 階層までサポートされる


# サブスクリプション
## 考慮すべきこと
- *管理グループに対してサブスクリプションを割り当てることで, ポリシーセットやロールの割り当てを継承させることができる[要検証]*
- 仮想ネットワークをサブスクリプション間で共有することはできない
  - ピアリングや VPN などが必要


# リソースグループ
- リージョンにメタデータが格納される
  - リージョンが使用できない場合にはリソースの更新ができない
- 名前の変更はできない


# Policy
- ポリシーに準拠していないリソースを表示できる
- ポリシーによってリソースが評価されるのは以下のタイミング
  - ポリシー割り当てのスコープでリソースが作成, 削除, 更新される
  - ポリシーまたはイニシアチブが新しくスコープに割り当てられる
  - スコープに対して割り当てられているポリシーまたはイニシアティブが更新される
  - 標準のコンプライアンス評価サイクル (24 時間ごとに発生)

# ランディングゾーン
- マルチサブスクリプション環境の出力
- Blueprint で管理できる


# Entra
## Entra ID
### 条件付きアクセス
- デバイスや場所(IP 範囲), クライアントアプリなどに基づいて, アクセス許可や MFA の要求, アクセスのブロックなどのアクションを実行できる
### パスワードハッシュ同期
- ハイブリッド環境で利用する

## ID Protection
- リスク検出および修復, リスク調査, リスク検出データのエクスポートが可能
- ログイン時にリスクが計算され, Protection ポリシーのしきい値を超えた場合にアクション(MFA など)を要求することができる
- リスクポリシーには以下の2つがある
  - ユーザーリスク
    - ID やアカウントが侵害されているおそれがある
    - "高" 以上のしきい値が推奨
      - 既知の攻撃パターンがないか確認できる
  - サインインリスク
    - サインインが ID 主勇者によって行われていないリスク
    - "中" 以上のしきい値が推奨
      - 自己修復オプションがサポートされる

## Entra ID Governance
### アクセスレビュー
- レビュー担当者に選べるのはリソースの所有者, 代理人, エンドユーザー
- 以下の自動アクションがサポートされる
  - 90 日以内に対話形式のサインインがなかったすべてのユーザーアカウントのアクセス権を削除する
  - セキュリティグループ `dynamics-access` からユーザーを削除する
- 完了するまでの指定時間内にレビューされないすべてのユーザーアカウントに対してアクセスレビューアクションを行う

## Entra External ID
### B2B
#### B2B コラボレーション
- ゲストユーザーとして共同作業するときに使用
- エンタイトルメント管理がサポートされる
  - ライフサイクル管理の大規模管理
- パートナーは自社の ID 管理システムを使用する(Entra ID でなくともよい)
- 外部プロバイダーを使用するように設定できる
#### B2B 直接接続
- Entra ID を使用するパートナーとの共同作業に使用
- サポートされるプロバイダは Entra ID のみ
### B2C
- 顧客がすでに作成している ID でサインインできる
- Azure AD B2C テナントを設定し, アプリを登録する必要がある
- **顧客は B2C ディレクトリで管理される**

## Entra Permissions Management
- マルチクラウド環境で ID のアクセス許可を管理

## ID プラットフォーム
### アプリケーションについて
- Entra ID 内でアプリを表せるのは以下の2つ
  - アプリケーションオブジェクト: **アプリの定義**
    - マルチテナントアプリケーションの場合にも, ホームディレクトリだけに存在する
  - サービスプリンシパル: **アプリのインスタンス**
    - アプリケーションオブジェクトの参照
    - 1 つのアプリケーションオブジェクトを複数のサービスプリンシパルが参照できる(異なるテナントにあってもよい)
    - アプリケーションが使用されるテナントごとに作成する必要がある

### サービスプリンシパル
#### サービスプリンシパルの種類
- **アプリケーション**
  - グローバルアプリケーションオブジェクトのローカル表現, インスタンス
  - アプリケーションオブジェクトから継承
  - 以下の操作において作成される
    - アプリケーションにテナント内のリソースへのアクセス許可が付与されたとき
    - portal でアプリケーションを登録したとき
- **マネージド ID**
  - 手動で更新することはできない
    - 更新したいときはマネージド ID がないサービスプリンシパルを使用する
- レガシ
#### 考慮事項
- リソースへの外部アプリの認証ができる

### マネージド ID
- Entra 認証と RBAC を組み合わせたもの
- マネージド ID を使用するようにアプリを構成するには**提供されたトークンを使用してサービスを呼び出す**
- 


# Monitor
- ログとメトリック(数値データ)から構成される
  - ログ: クエリによって複雑な分析が可能

## データソース
- **テナントデータ**: Entra ID など組織レベルのサービスについてのデータ
- **サブスクリプションデータ**: 正常性と可用性に関する情報
- **リソースデータ**
- **オペレーティングシステムデータ**: アプリケーションをホストする Windows または Linux の仮想マシンから取得されるデータ
- **アプリケーションデータ**: カスタムアプリケーション コードに関連するデータ

## Monitor ログワークスペース

## Workbooks
- データを分析し可視化できる

### 



#
##